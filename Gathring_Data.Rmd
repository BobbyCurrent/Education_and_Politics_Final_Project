---
title: "Data_Stuff"
author: "Bobby Current"
date: "10/8/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(janitor)
```

```{r}
school_spending_2017_2018 <-
spending_data_2018 <-
  read_excel("Raw_Data/Stfis180_1a.xlsx") %>%
group_by(STNAME) %>%
  select(STNAME, E11A)
  

districts_by_county <- read_excel("Raw_Data/grf19_lea_county.xlsx") %>%
  mutate(NAME_LEA19_UPPER = toupper(NAME_LEA19))

districts_by_county



plot_1 <- school_spending_2017_2018 %>%
  ggplot(aes(x = STNAME, y = E11A)) +
  geom_col() +
  labs(x = "State", 
       y = "Total Amount Paid", 
       title = "The Total Amount Paid to Teachers in 
       Regular Education Programs by State", 
       subtitle = "2017 - 2018 School Year") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))


district_spending <- read_csv("Raw_Data/archive/districts.csv") 


presidential_elections <- read_csv("Raw_Data/countypres_2000-2016.csv") %>%
  mutate(vote_prop = (candidatevotes / totalvotes)) %>%
  mutate(percent_won = (vote_prop * 100)) %>%
  filter(party %in% c("democrat", "republican"))
  
  presidential_elections

spending_by_state <- read_excel("Raw_Data/tabn236.25.xls", skip = 2) %>%
  clean_names()

spending_per_student_by_state <- read_excel("Raw_Data/public-school-per-pupil-expenditures.xlsx", skip = 3) %>%
  clean_names()

  
```



```{r join}

districts_and_counties <- left_join(district_spending, districts_by_county, by = c("NAME" = "NAME_LEA19_UPPER")) %>%
  mutate(NAME_COUNTY19 = str_replace(NAME_COUNTY19, "County", ""))


left_join(districts_and_counties, presidential_elections, by = c("NAME_COUNTY19" = "county"))








```

